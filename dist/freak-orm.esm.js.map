{"version":3,"file":"freak-orm.esm.js","sources":["../src/queryUtils.js","../src/schema.js","../src/modelBase.js","../src/models/array.js","../src/modelFacade.js","../src/main.js"],"sourcesContent":["/**\r\n * This is the default implementation of a query ascending behaviour.\r\n * Usually, custom models may replace this function generate their internal\r\n * query language.\r\n * @example\r\n * // used on a fetch query on some model.\r\n * model.fetch({ orderby: r => asc(r.id) });\r\n * @param {string} col The column to order in ascending order\r\n * @returns {function} A comparison function to use between two objects\r\n */\r\nexport function asc(col) {\r\n    return function (a, b) {\r\n        return a[col] - b[col];\r\n    }\r\n}\r\n\r\n/**\r\n * This is the default implementation of a query descending behaviour.\r\n * Usually, custom models may replace this function generate their internal\r\n * query language.\r\n * @example\r\n * // used on a fetch query on some model.\r\n * model.fetch({ orderby: r => desc(r.id) });\r\n * @param {string} col The column to order in descending order\r\n * @returns {function} A comparison function to use between two objects\r\n */\r\nexport function desc(col) {\r\n    return function (a, b) {\r\n        return b[col] - a[col];\r\n    }\r\n}\r\n\r\n/**\r\n * Helper function. It accumulates an array of asc or desc calls to implement\r\n * multi column sorting for local stores. It is usually used internally and should\r\n * not be used outside of building custom models.\r\n * @example\r\n * // multi column sorting\r\n * [\r\n *  {a: 1, b:1}, \r\n *  {a:1, b: 2}, \r\n *  {a: 2, b:1}, \r\n *  {a: 2, b: 2}\r\n * ].sort(multiColSort([asc('a'), desc('b')]))\r\n * // result:\r\n * [\r\n *  {a: 1, b: 2},\r\n *  {a: 1, b: 1},\r\n *  {a: 2, b: 2},\r\n *  {a: 2, b: 1}\r\n * ]\r\n * @param {Array} orderby An array or single asc/desc function to accumulate\r\n * @returns {function} A comparison function which combines the provided array of sort functions.\r\n */\r\nexport function multiColSort(orderby) {\r\n    if (orderby.constructor !== Array) {\r\n        orderby = [orderby];\r\n    }\r\n\r\n    let fn = orderby.shift();\r\n    return function (a, b) {\r\n        let result = fn(a, b);\r\n        if (result === 0 && orderby.length > 0) {\r\n            return multiColSort(orderby)(a, b);\r\n        }\r\n\r\n        return result;\r\n    }\r\n}\r\n\r\n/**\r\n * \r\n * @param {*} fn A value to test if is considered an arrow function.\r\n * @returns {boolean} true or false\r\n */\r\nexport function isArrowFunction(fn) {\r\n    let fnSrc = fn.toString();\r\n    return (/^\\s*(\\(\\s*\\)|\\([a-z0-9_=,\\s+\\{\\}\\.]+\\)|[a-z0-9_\\.]+)\\s*=>.+/).test(fnSrc);\r\n}","export class Schema {\r\n    constructor(options) {\r\n        this.options = options;\r\n    }\r\n\r\n    validate(field, value) {\r\n\r\n    }\r\n}","export class ModelBase {\r\n    constructor(model) {\r\n        this.model = model;\r\n    }\r\n\r\n    get isConnected() {\r\n        return false;\r\n    }\r\n\r\n    connect(data) {\r\n        return this.model.Promise.resolve(data);\r\n    }\r\n\r\n    disconnect(data) {\r\n        return this.model.Promise.resolve(data);\r\n    }\r\n\r\n    fetch(query) {\r\n        return this.model.Promise.resolve({ rows: [], total: 0 });\r\n    }\r\n\r\n    update(rows) {\r\n        return this.model.Promise.resolve({ rows: [] });\r\n    }\r\n\r\n    create(rows) {\r\n        return this.model.Promise.resolve({ rows: [] });\r\n    }\r\n\r\n    delete(rows) {\r\n        return this.model.Promise.resolve({ rows: [] });\r\n    }\r\n\r\n}","import { asc, desc, multiColSort } from '../queryUtils';\r\nimport { ModelBase } from '../modelBase';\r\n\r\nexport class ArrayModel extends ModelBase {\r\n    constructor(model) {\r\n        super(model);\r\n        this._data = this.model.options.data;\r\n        this._connected = false;\r\n    }\r\n\r\n    get isConnected() {\r\n        return this._connected;\r\n    }\r\n\r\n    async connect(data) {\r\n        return new Promise(resolve => {\r\n            this._connected = true;\r\n            return resolve(data)\r\n        });\r\n    }\r\n\r\n    async disconnect(data) {\r\n        return new Promise(resolve => {\r\n            this._connected = false;\r\n            return resolve(data)\r\n        });\r\n    }\r\n\r\n    async fetch({ where, orderby, start, limit }) {\r\n        return new Promise(success => {\r\n            let result = {\r\n                rows: [],\r\n                total: 100\r\n            }\r\n\r\n            if (start === undefined) { start = 0 }\r\n            if (limit === undefined) { limit = 20 }\r\n\r\n            let count = 0;\r\n            for (let i = 0; i < this._data.length; i++) {\r\n                let row = Object.assign({}, this._data[i]);\r\n\r\n                let matchCondition = where ? where(row) : true;\r\n                if (matchCondition) {\r\n                    result.rows.push(row);\r\n                }\r\n            }\r\n\r\n            let rowFields = {\r\n                id: 'id',\r\n                value: 'value',\r\n                description: 'description',\r\n                updated: 'updated'\r\n            }\r\n\r\n            if (orderby) {\r\n                result.rows = result.rows.sort(multiColSort(orderby(rowFields, asc, desc)));\r\n            }\r\n\r\n            result.rows = result.rows.slice(start, start + limit);\r\n\r\n            return success(result);\r\n        });\r\n    }\r\n\r\n    async update(data) {\r\n        return new Promise(success => {\r\n            data.rows.forEach(row => {\r\n\r\n                this._data.find((r, i) => {\r\n                    if (r.id == row.id) {\r\n                        this._data[i] = row;\r\n                        return true;\r\n                    }\r\n                })\r\n\r\n            });\r\n            return success(data);\r\n        });\r\n    }\r\n\r\n    async delete(ids) {\r\n        return new Promise(success => {\r\n            ids.forEach((id) => {\r\n                this._data.find((r, i) => {\r\n                    if (r.id == id) {\r\n                        this._data.splice(i, 1);\r\n                        return true;\r\n                    }\r\n                });\r\n            })\r\n\r\n            return success(ids);\r\n        });\r\n    }\r\n\r\n    async create(rows) {\r\n        return new Promise(success => {\r\n            let lastId = this._data[this._data.length - 1].id;\r\n            rows.forEach((row, i) => {\r\n                row.id = ++lastId;\r\n                this._data.push(row);\r\n            });\r\n\r\n            success({ rows });\r\n        });\r\n    }\r\n\r\n}","import { isArrowFunction } from './queryUtils';\r\nimport { EventEmitter } from 'events';\r\n\r\n/**\r\n * A convenient event argument container that allows async processing for subscribing events.\r\n * @example\r\n * // simple event\r\n * let EventEmitter = require('event');\r\n * let emitter = new EventEmitter();\r\n * let e = new EventArgs('myevent', emitter, { a: 1});\r\n * emitter.on('myevent', e => {\r\n *   // emulate a long running promise,\r\n *   // any event that requies pausing further flow can insert a promise.\r\n *   e.await(new Promise(resolve => {\r\n *     setTimeout(resolve, 5000);\r\n *   }));\r\n * })\r\n * \r\n * // triggers events and waits until all event promises resolve\r\n * e.wait().then(() => {\r\n *  console.log(\"Called after all event promises are resolved\");\r\n * })\r\n */\r\nexport class EventArgs {\r\n    constructor(eventName, base, args={}) {\r\n        this._base = base;\r\n        this.args = args;\r\n        this._promises = [];\r\n        this._eventName = eventName;\r\n    }\r\n\r\n    /**\r\n     * If an event handler needs to run a long running process, this method\r\n     * allows them the insert a promise into a wait queue so implementing code\r\n     * can wait for these promises to resolve or be rejected.\r\n     * @param {Promise} promise A promise to add to our wait list\r\n     */\r\n    await(promise) {\r\n        this._promises.push(promise);\r\n    }\r\n\r\n    /**\r\n     * If event handlers added long running promisses through the await function this method can be used\r\n     * to chain more processes that should only run after these event promises have resolved.\r\n     * @param {*} data A convenient way to enable this method to be chained. \r\n     *                 Any data passed will be passed along untouched down at the end of the wait promise.\r\n     * @returns {Promise} A promise which will pass the provided data object if passed.\r\n     */\r\n    wait(data) {\r\n        this._base.emit(this._eventName, {\r\n            name: this._eventName,\r\n            target: this._base,\r\n            args: this.args,\r\n            await: this.await.bind(this)\r\n        });\r\n        return Promise.all(this._promises).then(() => data);\r\n    }\r\n}\r\n\r\n/**\r\n * A model facade class that encapsulates promise handling and connection management.\r\n */\r\nexport class ModelFacade extends EventEmitter {\r\n\r\n    /**\r\n     * \r\n     * @param {*} options Model configuration\r\n     * @param {string} options.adapter Adapter to load\r\n     */\r\n    constructor(options) {\r\n        super();\r\n\r\n        this.options = Object.assign({\r\n            Promise\r\n        }, options);\r\n\r\n        if (typeof options.model == 'string') {\r\n            this._model = new require(options.model)(this);\r\n        } else {\r\n            this._model = new options.model(this);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Connects the model to its backend.\r\n     * @param {*} data Any object to pass along when Promise chained.\r\n     * @fires beforeConnect Before connecting event.\r\n     * @fires afterConnect After connecting event.\r\n     * @returns {Promise} A promise resolved once the model's backend is connected.\r\n     */\r\n    async connect(data) {\r\n        /**\r\n         * Before connecting\r\n         * @event beforeConnect\r\n         * @type {EventArgs}\r\n         */\r\n        let beforeConnectEvent = new EventArgs('beforeConnect', this, {});\r\n        /**\r\n         * After connecting\r\n         * @event afterConnect\r\n         * @type {EventArgs}\r\n         */\r\n        let afterConnectEvent = new EventArgs('afterConnect', this, {});\r\n\r\n        return beforeConnectEvent.wait(data)\r\n            .then(data => this._model.connect(data))\r\n            .then(data => afterConnectEvent.wait(data))\r\n    }\r\n\r\n    /**\r\n     * Disconnects the model from its backend\r\n     * @param {*} data Any object to pass along when Promise chained.\r\n     * @fires beforeDisconnect Before disconnecting event.\r\n     * @fires afterDisconnect After disconnecting event.\r\n     * @returns {Promise} A promise resolved once the model's backend is disconnected.\r\n     */\r\n    async disconnect(data) {\r\n        /**\r\n         * Before disconnecting\r\n         * @event beforeDisconnect\r\n         * @type {EventArgs}\r\n         */\r\n        let beforeDisconnectEvent = new EventArgs('beforeDisconnect', this, {});\r\n        /**\r\n         * After disconnecting\r\n         * @event aftereDisconnect\r\n         * @type {EventArgs}\r\n         */\r\n        let afterDisconnectEvent = new EventArgs('afterDisconnect', this, {});\r\n\r\n        return beforeDisconnectEvent.wait(data)\r\n            .then(data => this._model.disconnect(data))\r\n            .then(data => afterDisconnectEvent.wait(data))\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param {*} query \r\n     */\r\n    async fetch(query={}) {\r\n\r\n        /** Accept an arrow function as 'where' condition */\r\n        if (isArrowFunction(query)) {\r\n            query = { where: query };\r\n        }\r\n\r\n        let chain = Promise.resolve(query);\r\n        if (!this._model.isConnected) {\r\n            chain = chain.then(query => this.connect(query))\r\n        }\r\n\r\n        chain = chain.then(query => this._model.fetch(query))\r\n        if (this.options.autoDisconnect) {\r\n            chain = chain.then(this.disconnect);\r\n        }\r\n\r\n        return chain;\r\n    }\r\n\r\n    async update(rows) {\r\n        let chain = Promise.resolve(rows);\r\n        if (!this._model.isConnected) {\r\n            chain = chain.then(rows => this.connect(rows))\r\n        }\r\n\r\n        chain = chain.then(rows => this._model.update(rows))\r\n        if (this.options.autoDisconnect) {\r\n            chain = chain.then(result => this.disconnect(result));\r\n        }\r\n\r\n        return chain;\r\n    }\r\n\r\n    async create(rows) {\r\n        let chain = Promise.resolve(rows);\r\n        if (!this._model.isConnected) {\r\n            chain = chain.then(rows => this.connect(rows))\r\n        }\r\n\r\n        chain = chain.then(rows => this._model.create(rows));\r\n        if (this.options.autoDisconnect) {\r\n            chain = chain.then(result => this.disconnect(result));\r\n        }\r\n\r\n        return chain;\r\n    }\r\n\r\n    async delete(ids) {\r\n        let chain = Promise.resolve(ids);\r\n\r\n        if (!this._model.isConnected) {\r\n            chain = chain.then(ids => this._model.connect(ids))\r\n        }\r\n\r\n        chain = chain.then(ids => this._model.delete(ids));\r\n        if (this.options.autoDisconnect) {\r\n            chain = chain.then(result => this.disconnect(result));\r\n        }\r\n\r\n        return chain;\r\n    }\r\n}","import * as queryUtils from './queryUtils';\r\nexport { Schema } from './schema';\r\nexport { ModelBase } from './modelBase';\r\nexport { ArrayModel } from './models/array';\r\nimport { ModelFacade } from './modelFacade';\r\n\r\nexport function createModel(options) {\r\n    return new ModelFacade(options);\r\n}\r\n\r\nexport { ModelFacade, queryUtils };"],"names":[],"mappings":"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"}